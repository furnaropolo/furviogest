{{template "base" .}}

{{define "content"}}
<div class="page-header">
    <h1><i class="bi bi-clock-history"></i> Storico Interventi - {{.Data.NomeNave}}</h1>
    <p class="text-muted">{{.Data.NomeCompagnia}}</p>
</div>

<div class="card">
    <div class="card-body">
        {{if .Data.Rapporti}}
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>Data</th>
                    <th>Tipo</th>
                    <th>Porto</th>
                    <th>Descrizione</th>
                    <th>PDF</th>
                    <th>Azioni</th>
                </tr>
            </thead>
            <tbody>
                {{range .Data.Rapporti}}
                <tr>
                    <td>
                        {{.DataIntervento}}
                        {{if .DataFine}}<br><small class="text-muted">â†’ {{.DataFine}}</small>{{end}}
                    </td>
                    <td>
                        {{if eq .Tipo "wifi"}}<span class="badge bg-info">WiFi</span>
                        {{else if eq .Tipo "gsm"}}<span class="badge bg-success">GSM</span>
                        {{else}}<span class="badge bg-secondary">{{.Tipo}}</span>{{end}}
                    </td>
                    <td>{{.NomePorto}}</td>
                    <td>{{if gt (len .Descrizione) 100}}{{slice .Descrizione 0 100}}...{{else}}{{.Descrizione}}{{end}}</td>
                    <td>
                        {{if .PdfPath}}
                        <a href="{{.PdfPath}}" target="_blank" class="btn btn-sm btn-outline-primary">
                            <i class="bi bi-file-pdf"></i> PDF
                        </a>
                        {{else}}
                        <span class="text-muted">-</span>
                        {{end}}
                    </td>
                    <td>
                        <a href="/rapporti/dettaglio/{{.ID}}" class="btn btn-sm btn-primary">
                            <i class="bi bi-eye"></i> Dettaglio
                        </a>
                    </td>
                </tr>
                {{end}}
            </tbody>
        </table>
        {{else}}
        <div class="text-center py-5">
            <i class="bi bi-inbox" style="font-size: 3rem; color: #ccc;"></i>
            <p class="text-muted mt-3">Nessun intervento registrato per questa nave</p>
            <a href="/rapporti/nuovo" class="btn btn-primary">
                <i class="bi bi-plus-lg"></i> Crea Nuovo Rapporto
            </a>
        </div>
        {{end}}
    </div>
</div>

<div class="mt-3">
    <a href="/navi" class="btn btn-secondary"><i class="bi bi-arrow-left"></i> Torna alle Navi</a>
</div>
{{end}}
