{{define "content"}}
<div class="container-fluid">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2><i class="bi bi-exclamation-triangle me-2"></i>Segnalazione Guasti Nave</h2>
        <a href="/guasti-nave/storico" class="btn btn-outline-secondary"><i class="bi bi-clock-history me-1"></i>Storico Guasti</a>
    </div>

    {{if .Data}}
    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead class="table-dark">
                <tr>
                    <th>Nave</th>
                    <th>Compagnia</th>
                    <th>AP Fault</th>
                    <th>Guasti Aperti</th>
                    <th>Azioni</th>
                </tr>
            </thead>
            <tbody>
                {{range .Data}}
                <tr class="{{if gt .APFault 0}}table-danger{{else if gt .GuastiAlti 0}}table-danger{{else if gt .GuastiAperti 0}}table-warning{{end}}">
                    <td><strong>{{.Nome}}</strong></td>
                    <td>{{.Compagnia}}</td>
                    <td>
                        {{if gt .APFault 0}}
                            <span class="badge bg-danger fs-6">
                                <i class="bi bi-wifi-off me-1"></i>{{.APFault}} AP
                            </span>
                        {{else}}
                            <span class="text-success"><i class="bi bi-wifi me-1"></i>OK</span>
                        {{end}}
                    </td>
                    <td>
                        {{if gt .GuastiAperti 0}}
                            <span class="badge bg-{{if gt .GuastiAlti 0}}danger{{else}}warning text-dark{{end}} fs-6">
                                {{.GuastiAperti}} guast{{if eq .GuastiAperti 1}}o{{else}}i{{end}}
                            </span>
                            {{if gt .GuastiAlti 0}}
                            <span class="badge bg-danger ms-1">{{.GuastiAlti}} alta priorita</span>
                            {{end}}
                        {{else}}
                            <span class="text-success"><i class="bi bi-check-circle me-1"></i>Nessun guasto</span>
                        {{end}}
                    </td>
                    <td>
                        <a href="/guasti-nave/{{.ID}}" class="btn btn-sm btn-primary">
                            <i class="bi bi-eye me-1"></i>Gestisci Guasti
                        </a>
                    </td>
                </tr>
                {{end}}
            </tbody>
        </table>
    </div>
    {{else}}
    <div class="alert alert-info">
        <i class="bi bi-info-circle me-2"></i>Nessuna nave presente.
    </div>
    {{end}}
</div>
{{end}}
